<div class="post">
  <div class="post-header">
    <h1>{{ post.title }}</h1>
    <div class="post-info">
      <div class="team">
        <h4> {{ post.team_name }}</h4>
      </div>
      <h4> {{ post.username }}</h4>
      <h4> {{ post.posted_on |  date:'short'}}</h4>
    </div>
  </div>
  <div class="post-content" [innerHTML]="adjustedContent" (click)="onContentClick($event)"></div>
  <div class="post-panel">
    <div class="likes-comments-counter">
      <button (click)="onShowLikes()" cdkOverlayOrigin #trigger="cdkOverlayOrigin">
        {{ countLikes() }} {{ countLikes() == 1 ? 'Like' : 'Likes' }}
      </button>
      <button (click)="goToDetail()">
        {{ post.count_comments }} {{ post.count_comments == 1 ? 'Comment' : 'Comments' }}
      </button>
    </div>

    @if (authService.isLoggedInSig()) {
      <div class="interact-buttons">
        <div class="like-comment-buttons">
          @if(post.hasLiked){
            <i (click)="onUnlikePost()" class="fa fa-heart interact"></i>
          } @else {
            <i (click)="onLikePost()" class="far fa-heart interact"></i>
          }
          <i [routerLink]="`${post.id}`" class="far fa-commenting interact"></i>
        </div>

        <div [class.invisible]="!userCanEdit" class="edit-delete-buttons">
            <i [routerLink]="`/posts/edit/${post.id}`" class="fa fa-pen-to-square interact"></i>
            <i (click)="onDelete()" class="fa fa-trash interact"></i>
        </div>
      </div>
    }
  </div>

</div> 

<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayOpen]="showLikes"
  (detach)="showLikes = false"
  (overlayOutsideClick)="showLikes = false"
>
  <div class="likes-list-overlay">
    <h3>List of likes</h3>
    <div class="counter">
      <i
        class="fa-solid fa-angle-left interact"
        [class.not-show]="!prevLikesPage"
        (click)="getPrevLikesPage()"
      ></i>
      <p> {{startLikes()}} - {{endLikes()}} of {{countLikes()}}</p>
      <i
        class="fa-solid fa-angle-right interact"
        [class.not-show]="!nextLikesPage"
        (click)="getNextLikesPage()"
      ></i>
    </div>
    @for (like of likes; track $index) {
      <p class="like"> {{like.username}}</p>
    }
  </div>
</ng-template>
